<!DOCTYPE html>
<html lang="en">
<head>
<meta charset='utf-8'/><meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Protect Winbox From Exploit - Mikrotik Script RouterOS</title>
<meta content='Protect Router Winbox From Exploit - Mikrotik Script' name='description'/>
<meta content='mikrotik script, routeros script, script database, script, mikrotik, routeros, router, hotspot, rtrwnet' name='keywords'/>
<meta content='index, follow' name='robots'/><meta http-equiv="expires" content="0"/>
<link rel="stylesheet" href="//router-os.github.io/stytes.css"/>
<link rel="stylesheet" href="//router-os.github.io/highlightjs/styles/github.css"/>
<script src="//router-os.github.io/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>  
</head> 
<body>
<pre>
<h1>Protect Winbox From Exploit (VULNERABILITY) - Mikrotik Script</h1>
This post summarises the Winbox server vulnerability in RouterOS, discovered and fixed in RouterOS on April 23, 2018. 
Note that although Winbox was used as point of attack, the vulnerabilitty was in RouterOS. This issue was later assigned a universal identifier CVE-2018-14847. 

How it works: The vulnerability allowed a special tool to connect to the Winbox port, and request the system user database file. 

Versions affected:

Affected all bugfix releases from 6.30.1 to 6.40.7, fixed in 6.40.8 on 2018-Apr-23
Affected all current releases from 6.29 to 6.42, fixed in 6.42.1 on 2018-Apr-23
Affected all RC releases from 6.29rc1 to 6.43rc3, fixed in 6.43rc4 on on 2018-Apr-23

Am I affected? Currently there is no sure way to see if you were affected. If your Winbox port is open to untrusted networks, 
assume that you are affected and upgrade + change password + add firewall according to our guidelines. Make sure that you change password after an upgrade. 
The log may show unsuccessful login attempt, followed by a succefful login attempt from unknown IP addresses. 

How to Protect?

<code>/ip firewall filter
add action=reject chain=input comment="PROTECT ROUTER" in-interface=ether1 content=user.dat reject-with=icmp-network-unreachable
add action=drop chain=input in-interface=ether1 content="user.dat"</code>
</pre>
<br>
<img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Frouter-os.github.io%2F&count_bg=%23C83D3D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false" alt="Hits"/>
<br><br>
<a href="https://router-os.github.io/"><- Back To Home</a>
</body>
</html>
